import { decodeVersionedPayload } from '../utils';

describe('utils', () => {
  it('decodeVersionedPayload', () => {
    const rawPayloadFromGateway =
      '0x00000001000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000003400000000000000000000000000000000000000000000000000000000000000013726563656976655f6d6573736167655f65766d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000000c736f757263655f636861696e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e736f757263655f6164647265737300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000077061796c6f6164000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000006737472696e6700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006737472696e670000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000562797465730000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000008657468657265756d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a3078356233343837366666623136353637313066623936336563643139396336663137336332393236370000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000002a30786531373063373031643832613735346261316537623534616237353664386330326637623235386500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001368656c6c6f2066726f6d20657468657265756d00000000000000000000000000';

    const result = decodeVersionedPayload(rawPayloadFromGateway);

    expect(result).toEqual({
      methodName: 'receive_message_evm',
      argNames: ['source_chain', 'source_address', 'payload'],
      argTypes: ['string', 'string', 'bytes'],
      argValues: [
        'ethereum',
        '0x5b34876ffb1656710fb963ecd199c6f173c29267',
        'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAqMHhlMTcwYzcwMWQ4MmE3NTRiYTFlN2I1NGFiNzU2ZDhjMDJmN2IyNThlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATaGVsbG8gZnJvbSBldGhlcmV1bQAAAAAAAAAAAAAAAAA=',
      ],
    });
  });
});
